<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Strict//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>R:\Cloud\360Cloud\Easy Project\EasyProject\项目\EasyShiro\easyshiro\github\doc\.readme-zh-CN.md.html</title>


<style type="text/css">
body {
	color: #333;
	font: 13px/1.4 "Helvetica Neue", Helvetica, "Segoe UI", Arial, freesans, sans-serif;
	padding: 0;
	margin: 0;
}

a {
	background: transparent;
	color: #4183c4;
	text-decoration: none;
}

a:active,
a:hover {
	outline: 0 none;
	text-decoration: underline;
}

abbr[title] {
	border-bottom: 1px dotted;
}

b,
strong {
	font-weight: bold;
}

dfn {
	font-style: italic;
}
h1 {
	font-size: 2em;
	margin: 0.67em 0;
}
mark {
	background: #ff0;
	color: #000;
}
small {
	font-size: 80%;
}
sub, sup {
	font-size: 75%;
	line-height: 0;
	position: relative;
	vertical-align: baseline;
}
sup {
	top: -0.5em;
}
sub {
	bottom: -0.25em;
}
img {
	border: 0 none;
}
svg:not(:root) {
	overflow: hidden;
}
figure {
	margin: 1em 40px;
}
hr {
	box-sizing: content-box;
	height: 0;
}

code,
kbd,
pre,
samp {
	font-family: monospace,monospace;
	font-size: 1em;
}

pre {
	overflow: auto;
	font: 12px Consolas,"Liberation Mono",Menlo,Courier,monospace;
	margin-bottom: 0;
	margin-top: 0;
}

.markdown-body {
	padding: 30px;
	font-size: 16px;
	line-height: 1.6;
	word-wrap: break-word;
}

.markdown-body>*:first-child {
	margin-top: 0 !important;
}

.markdown-body>*:last-child {
	margin-bottom: 0 !important;
}

.markdown-body .absent {
	color: #c00;
}

.markdown-body .anchor {
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	display: block;
	padding-right: 6px;
	padding-left: 30px;
	margin-left: -30px;
}

.markdown-body .anchor:focus {
	outline: none;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
	position: relative;
	margin-top: 1em;
	margin-bottom: 16px;
	font-weight: bold;
	line-height: 1.4;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
	display: none;
	color: #000;
	vertical-align: middle;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
	padding-left: 8px;
	margin-left: -30px;
	line-height: 1;
	text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
	display: inline-block;
}

.markdown-body h1 tt,
.markdown-body h1 code,
.markdown-body h2 tt,
.markdown-body h2 code,
.markdown-body h3 tt,
.markdown-body h3 code,
.markdown-body h4 tt,
.markdown-body h4 code,
.markdown-body h5 tt,
.markdown-body h5 code,
.markdown-body h6 tt,
.markdown-body h6 code {
	font-size: inherit;
}

.markdown-body h1 {
	padding-bottom: 0.3em;
	font-size: 2.25em;
	line-height: 1.2;
	border-bottom: 1px solid #eee;
}

.markdown-body h2 {
	padding-bottom: 0.3em;
	font-size: 1.75em;
	line-height: 1.225;
	border-bottom: 1px solid #eee;
}

.markdown-body h3 {
	font-size: 1.5em;
	line-height: 1.43;
}

.markdown-body h4 {
	font-size: 1.25em;
}

.markdown-body h5 {
	font-size: 1em;
}

.markdown-body h6 {
	font-size: 1em;
	color: #777;
}

.markdown-body p,.markdown-body blockquote,
.markdown-body ul,.markdown-body ol,
.markdown-body dl,.markdown-body table,
.markdown-body pre {
	margin-top: 0;
	margin-bottom: 16px;
}

.markdown-body hr {
	height: 4px;
	padding: 0;
	margin: 16px 0;
	background-color: #e7e7e7;
	border: 0 none;
}

.markdown-body ul,
.markdown-body ol {
	padding-left: 2em;
}

.markdown-body ul.no-list,
.markdown-body ol.no-list {
	padding: 0;
	list-style-type: none;
}

.markdown-body ul ul,
.markdown-body ul ol,
.markdown-body ol ol,
.markdown-body ol ul {
	margin-top: 0;
	margin-bottom: 0;
}

.markdown-body li>p {
	margin-top: 16px;
}

.markdown-body dl {
	padding: 0;
}

.markdown-body dl dt {
	padding: 0;
	margin-top: 16px;
	font-size: 1em;
	font-style: italic;
	font-weight: bold;
}

.markdown-body dl dd {
	padding: 0 16px;
	margin-bottom: 16px;
}

.markdown-body blockquote {
	padding: 0 15px;
	color: #777;
	border-left: 4px solid #ddd;
}

.markdown-body blockquote>:first-child {
	margin-top: 0;
}

.markdown-body blockquote>:last-child {
	margin-bottom: 0;
}

.markdown-body table {
	display: block;
	width: 100%;
	overflow: auto;
	word-break: normal;
	word-break: keep-all;
}

.markdown-body table th {
	font-weight: bold;
}

.markdown-body table th,
.markdown-body table td {
	padding: 6px 13px;
	border: 1px solid #ddd;
}

.markdown-body table tr {
	background-color: #fff;
	border-top: 1px solid #ccc;
}

.markdown-body table tr:nth-child(2n) {
	background-color: #f8f8f8;
}

.markdown-body img {
	max-width: 100%;
	-moz-box-sizing: border-box;
	box-sizing: border-box;
}

.markdown-body span.frame {
	display: block;
	overflow: hidden;
}

.markdown-body span.frame>span {
	display: block;
	float: left;
	width: auto;
	padding: 7px;
	margin: 13px 0 0;
	overflow: hidden;
	border: 1px solid #ddd;
}

.markdown-body span.frame span img {
	display: block;
	float: left;
}

.markdown-body span.frame span span {
	display: block;
	padding: 5px 0 0;
	clear: both;
	color: #333;
}

.markdown-body span.align-center {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-center>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: center;
}

.markdown-body span.align-center span img {
	margin: 0 auto;
	text-align: center;
}

.markdown-body span.align-right {
	display: block;
	overflow: hidden;
	clear: both;
}

.markdown-body span.align-right>span {
	display: block;
	margin: 13px 0 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body span.align-right span img {
	margin: 0;
	text-align: right;
}

.markdown-body span.float-left {
	display: block;
	float: left;
	margin-right: 13px;
	overflow: hidden;
}

.markdown-body span.float-left span {
	margin: 13px 0 0;
}

.markdown-body span.float-right {
	display: block;
	float: right;
	margin-left: 13px;
	overflow: hidden;
}

.markdown-body span.float-right>span {
	display: block;
	margin: 13px auto 0;
	overflow: hidden;
	text-align: right;
}

.markdown-body code,.markdown-body tt {
	padding: 0;
	padding-top: 0.2em;
	padding-bottom: 0.2em;
	margin: 0;
	font-size: 85%;
	background-color: rgba(0,0,0,0.04);
	border-radius: 3px;
}

.markdown-body code:before,
.markdown-body code:after,
.markdown-body tt:before,
.markdown-body tt:after {
	letter-spacing: -0.2em;
	content: "\00a0";
}

.markdown-body code br,
.markdown-body tt br {
	display: none;
}

.markdown-body del code {
	text-decoration: inherit;
}

.markdown-body pre>code {
	padding: 0;
	margin: 0;
	font-size: 100%;
	word-break: normal;
	white-space: pre;
	background: transparent;
	border: 0;
}

.markdown-body .highlight {
	margin-bottom: 16px;
}

.markdown-body .highlight pre,
.markdown-body pre {
	padding: 16px;
	overflow: auto;
	font-size: 85%;
	line-height: 1.45;
	background-color: #f7f7f7;
	border-radius: 3px;
}

.markdown-body .highlight pre {
	margin-bottom: 0;
	word-break: normal;
}

.markdown-body pre {
	word-wrap: normal;
}

.markdown-body pre code,
.markdown-body pre tt {
	display: inline;
	max-width: initial;
	padding: 0;
	margin: 0;
	overflow: initial;
	line-height: inherit;
	word-wrap: normal;
	background-color: transparent;
	border: 0;
}

.markdown-body pre code:before,
.markdown-body pre code:after,
.markdown-body pre tt:before,
.markdown-body pre tt:after {
	content: normal;
}

.highlight .pl-coc,
.highlight .pl-entl,
.highlight .pl-entm,
.highlight .pl-eoa,
.highlight .pl-mai .pl-sf,
.highlight .pl-mm,
.highlight .pl-pdv,
.highlight .pl-sc,
.highlight .pl-som,
.highlight .pl-sr,
.highlight .pl-v,
.highlight .pl-vpf {
	color: #0086b3;
}
.highlight .pl-eoac,
.highlight .pl-mdht,
.highlight .pl-mi1,
.highlight .pl-mri,
.highlight .pl-va,
.highlight .pl-vpu {
	color: #008080;
}
.highlight .pl-c,
.highlight .pl-pdc {
	color: #b4b7b4;
	font-style: italic;
}
.highlight .pl-k,
.highlight .pl-ko,
.highlight .pl-kolp,
.highlight .pl-mc,
.highlight .pl-mr,
.highlight .pl-ms,
.highlight .pl-s,
.highlight .pl-sok,
.highlight .pl-st {
	color: #6e5494;
}
.highlight .pl-ef,
.highlight .pl-enf,
.highlight .pl-enm,
.highlight .pl-entc,
.highlight .pl-eoi,
.highlight .pl-sf,
.highlight .pl-smc {
	color: #d12089;
}
.highlight .pl-ens,
.highlight .pl-eoai,
.highlight .pl-kos,
.highlight .pl-mh .pl-pdh,
.highlight .pl-mp,
.highlight .pl-pde,
.highlight .pl-stp {
	color: #458;
}
.highlight .pl-enti {
	color: #d12089;
	font-weight: bold;
}
.highlight .pl-cce,
.highlight .pl-enc,
.highlight .pl-kou,
.highlight .pl-mq {
	color: #f93;
}
.highlight .pl-mp1 .pl-sf {
	color: #458;
	font-weight: bold;
}
.highlight .pl-cos,
.highlight .pl-ent,
.highlight .pl-md,
.highlight .pl-mdhf,
.highlight .pl-ml,
.highlight .pl-pdc1,
.highlight .pl-pds,
.highlight .pl-s1,
.highlight .pl-scp,
.highlight .pl-sol {
	color: #df5000;
}
.highlight .pl-c1,
.highlight .pl-cn,
.highlight .pl-pse,
.highlight .pl-pse .pl-s2,
.highlight .pl-vi {
	color: #a31515;
}
.highlight .pl-mb,
.highlight .pl-pdb {
	color: #df5000;
	font-weight: bold;
}
.highlight .pl-mi,
.highlight .pl-pdi {
	color: #6e5494;
	font-style: italic;
}
.highlight .pl-ms1 {
	background-color: #f5f5f5;
}
.highlight .pl-mdh,
.highlight .pl-mdi {
	font-weight: bold;
}
.highlight .pl-mdr {
	color: #0086b3;
	font-weight: bold;
}
.highlight .pl-s2 {
	color: #333;
}
.highlight .pl-ii {
	background-color: #df5000;
	color: #fff;
}
.highlight .pl-ib {
	background-color: #f93;
}
.highlight .pl-id {
	background-color: #a31515;
	color: #fff;
}
.highlight .pl-iu {
	background-color: #b4b7b4;
}
.highlight .pl-mo {
	color: #969896;
}

</style>


<script type="text/javascript">

function getDocumentScrollTop() 
{
   var res = document.body.scrollTop || document.documentElement.scrollTop || window.pageYOffset || 0;
   // alert(res);
   return res;
}

function setDocumentScrollTop(ypos) 
{
	window.scrollTo(0, ypos);
}

</script>


</head>
<body class="markdown-body">
<h1> <a id="easyshiro" class="anchor" href="#easyshiro" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EasyShiro</h1> 
<hr /> 
<p>EasyShiro 是一个基于 Shiro 的安全扩展组件。为基于数据库权限管理和 <strong>Web URL 授权</strong> 的 RBAC（Role Based Access Control） Web 权限模型，提供通用的 Shiro 安全管理支持，以及更加丰富强大的功能选项。</p> 
<h2> <a id="简介" class="anchor" href="#%E7%AE%80%E4%BB%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>简介</h2> 
<ul> 
 <li> <p><strong>Apache Shiro</strong></p> <p><a href="http://shiro.apache.org/" title=" Apache Shiro " rel="nofollow">Apache Shiro</a> 是目前最为强大和全面的 Java 安全管理框架，提供用户认证，授权（基于角色和权限），Session 管理，加密，Web及第三方集成等等。但 Apache Shiro 只是一个安全引擎，并非一个权限管理系统，日常项目的权限管理系统仍需自行实现，不同的项目往往需要自定义众多不同的安全组件，而且配置繁复。</p> </li> 
 <li> <p><strong>EasyShiro</strong></p> <p>EasyShiro 是一个基于 Shiro 的安全扩展组件。为基于数据库权限管理和 <strong>Web URL 授权</strong>的RBAC（Role Based Access Control） Web 权限模型，提供通用的 Shiro 安全管理支持。</p> </li> 
 <li> <p><strong>EasyShiro-Redis-Cache</strong></p> <p>基于 Redis 的 Shrio 缓存，支持 Jedis 直连和 Spring-Data-Redis RedisTemplate。<a href="https://github.com/ushelp/EasyShiro-Redis-Cache">https://github.com/ushelp/EasyShiro-Redis-Cache</a></p> </li> 
</ul> 
<h2> <a id="easyshiro-特点" class="anchor" href="#easyshiro-%E7%89%B9%E7%82%B9" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>EasyShiro 特点</h2> 
<ol> 
 <li> <p>支持基于基于数据库权限管理和 <strong>Web URL</strong> 授权的 RBAC 权限管理</p> </li> 
 <li> <p>增强简化的 Shiro 统一组件支持。提供通用的 <strong>验证码</strong>，<strong>自动登录</strong>，<strong>登录锁定</strong>，<strong>错误消息配置</strong>，<strong>拦截器</strong>，<strong>Ajax 响应</strong> 等等支持</p> </li> 
 <li> <p>配置简单，简化安全集成，减少 Shiro 的复杂性。提供了完整的<strong>通用配置模板</strong>(<code>shiro.ini</code>, <code>spring-shiro.xml</code>)仅需加入 <code>jar</code> 包，按需求调整部分配置选项，即可完成集成，享受完整的 Shiro 支持</p> </li> 
 <li> <p>基于 <code>User</code> 和 <code>IP</code> 的 <strong>LockLogin</strong> 登录锁定功能，并提供登录锁定管理系统 <strong>LockLoginManagement</strong></p> </li> 
</ol> 
<h2> <a id="主要模块" class="anchor" href="#%E4%B8%BB%E8%A6%81%E6%A8%A1%E5%9D%97" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>主要模块</h2> 
<h3> <a id="1-增强简化的-shiro-统一组件支持" class="anchor" href="#1-%E5%A2%9E%E5%BC%BA%E7%AE%80%E5%8C%96%E7%9A%84-shiro-%E7%BB%9F%E4%B8%80%E7%BB%84%E4%BB%B6%E6%94%AF%E6%8C%81" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 增强简化的 Shiro 统一组件支持</h3> 
<ul> 
 <li> <p><strong>Auth</strong>：<code>EasyFormAuthenticationFilter</code>，功能全面的认证过滤器，提供验证码（CAPTCHA），自动登录（AutoLogin），登录锁定（LockLogin），异常消息自定义（exceptionMsg），重定向跳转，拦截器，多次登录等等功能</p> </li> 
 <li> <p><strong>Realm</strong>：<code>EasyJdbcRealm</code>，基于数据库的Realm，从数据库自动获取认证和授权数据，支持权限刷新</p> </li> 
 <li> <p><strong>Perms</strong>：<code>EasyURLPermissionFilter</code>，授权管理过滤器，基于Web 请求 URL 的授权管理，支持 Ajax 响应</p> </li> 
 <li> <p><strong>Logout</strong>：<code>EasyLogoutFilter</code>，用户注销过滤器，提供自动登录相关的注销</p> </li> 
 <li> <p><strong>Interceptor</strong>：认证与 Realm 拦截器支持(<code>EasyAuthenticationInterceptor</code>，<code>EasyJdbcRealmInterceptor</code>)，支持在认证成功或失败时进行扩展</p> </li> 
 <li> <p><strong>EasyUsernamePasswordEndcodeToken</strong>：简化并方案更加灵活的密码加密Token，实现 <code>encodePassword()</code>，返回密码加密后的结果</p> </li> 
 <li> <p><strong>Exception</strong>：登录认证相关自定义异常（<code>EasyIncorrectCaptchaException</code>，<code>EasyLockIPException</code>，<code>EasyLockUserException</code>，<code>EasyLockLoginException</code>）</p> </li> 
</ul> 
<h3> <a id="2-登录锁定管理系统-lockloginmanagement" class="anchor" href="#2-%E7%99%BB%E5%BD%95%E9%94%81%E5%AE%9A%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F-lockloginmanagement" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 登录锁定管理系统 LockLoginManagement</h3> 
<p><a href="images/locklogin1.png" target="_blank"><img src="images/locklogin1.png" alt="LockLogin" style="max-width:100%;" /></a></p> 
<h2> <a id="rbca-模型" class="anchor" href="#rbca-%E6%A8%A1%E5%9E%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>RBCA 模型</h2> 
<p>下面展示和提供了一个常见的基于数据库权限管理，菜单授权， Web URL 授权的 RBAC（Role Based Access Control） Web 权限模型。</p> 
<p><a href="images/rbca.png" target="_blank"><img src="images/rbca.png" alt="RBCA" style="max-width:100%;" /></a></p> 
<h2> <a id="使用步骤" class="anchor" href="#%E4%BD%BF%E7%94%A8%E6%AD%A5%E9%AA%A4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>使用步骤</h2> 
<ol> 
 <li> <p>加入 <code>jar</code> 依赖</p> </li> 
 <li> <p>在 <code>web.xml</code> 配置过滤器</p> </li> 
 <li> <p>使用 <code>Spring</code> 或 <code>INI</code> 配置 <code>Shiro</code></p> </li> 
</ol> 
<h3> <a id="1-加入-jar-依赖" class="anchor" href="#1-%E5%8A%A0%E5%85%A5-jar-%E4%BE%9D%E8%B5%96" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 加入 jar 依赖</h3> 
<div class="highlight highlight-text-xml">
 <pre>&lt;<span class="pl-ent">dependency</span>&gt;
    &lt;<span class="pl-ent">groupId</span>&gt;cn.easyproject&lt;/<span class="pl-ent">groupId</span>&gt;
    &lt;<span class="pl-ent">artifactId</span>&gt;easyshiro&lt;/<span class="pl-ent">artifactId</span>&gt;
    &lt;<span class="pl-ent">version</span>&gt;2.6.0-RELEASE&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
</div> 
<h3> <a id="2-在-webxml-配置过滤器" class="anchor" href="#2-%E5%9C%A8-webxml-%E9%85%8D%E7%BD%AE%E8%BF%87%E6%BB%A4%E5%99%A8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 在 <code>web.xml</code> 配置过滤器</h3> 
<pre><code>&lt;!-- Shiro Spring Intergation --&gt;
&lt;!-- The filter-name matches name of a 'shiroFilter' bean inside applicationContext.xml --&gt;
&lt;filter&gt;
    &lt;filter-name&gt;shiroFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.DelegatingFilterProxy&lt;/filter-class&gt;
    &lt;init-param&gt;
        &lt;param-name&gt;targetFilterLifecycle&lt;/param-name&gt;
        &lt;param-value&gt;true&lt;/param-value&gt;
    &lt;/init-param&gt;
&lt;/filter&gt;

&lt;!-- Shiro Web Intergation(shiro.ini, not spring) --&gt;
&lt;!--  
&lt;listener&gt;
    &lt;listener-class&gt;org.apache.shiro.web.env.EnvironmentLoaderListener&lt;/listener-class&gt;
&lt;/listener&gt;
&lt;filter&gt;
    &lt;filter-name&gt;shiroFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.apache.shiro.web.servlet.ShiroFilter&lt;/filter-class&gt;
&lt;/filter&gt; 
--&gt; 
	
&lt;!-- Make sure any request you want accessible to Shiro is filtered. /* catches all --&gt;
&lt;!-- requests. Usually this filter mapping is defined first (before all others) to --&gt;
&lt;!-- ensure that Shiro works in subsequent filters in the filter chain: --&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;shiroFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
    &lt;dispatcher&gt;REQUEST&lt;/dispatcher&gt;
    &lt;dispatcher&gt;FORWARD&lt;/dispatcher&gt;
    &lt;dispatcher&gt;INCLUDE&lt;/dispatcher&gt;
    &lt;dispatcher&gt;ERROR&lt;/dispatcher&gt;
&lt;/filter-mapping&gt;
</code></pre> 
<h3> <a id="3-配置模板" class="anchor" href="#3-%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 配置模板</h3> 
<h4> <a id="31-扩展配置按需调整" class="anchor" href="#31-%E6%89%A9%E5%B1%95%E9%85%8D%E7%BD%AE%E6%8C%89%E9%9C%80%E8%B0%83%E6%95%B4" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.1 扩展配置，按需调整</h4> 
<ul> 
 <li> <p><strong>EasyJdbcRealm</strong></p> </li> 
 <li> <p>配置密码列（<code>passwordColumn</code>）</p> </li> 
 <li> <p>认证语句（<code>authenticationQuery</code>）</p> </li> 
 <li> <p>角色查询语句（<code>userRolesQuery</code>）</p> </li> 
 <li> <p>权限查询语句（<code>permissionsQuery</code>）</p> </li> 
 <li> <p>查询语句中支持多个<code>?</code>占位符（有利于 <code>union</code> 查询）。</p> </li> 
 <li> <p><strong>EasyFormAuthenticationFilter</strong></p> </li> 
 <li> <p><strong>扩展基本配置</strong></p> </li> 
 <li> <p>登录成功存入 session 的 Token 名 （<code>sessionTokenKey</code>）</p> </li> 
 <li> <p>是否开启登录重定向（<code>loginFailureRedirectToLogin</code>）</p> </li> 
 <li> <p>登录使用的扩展 Token 类完全限定名（<code>tokenClassName</code>）</p> </li> 
 <li> <p>认证成功或失败自定义拦截器（<code>interceptor</code>），需要实现 <code>EasyAuthenticationInterceptor</code> 接口</p> </li> 
 <li> <p><strong>CAPTCHA 验证码配置</strong></p> </li> 
 <li> <p>是否开启验证码（<code>enableCaptcha</code>）</p> </li> 
 <li> <p>验证码参数名（<code>captchaParam</code>）</p> </li> 
 <li> <p>session中存储的验证码名 （<code>sessionCaptchaKey</code>）</p> </li> 
 <li> <p><strong>AutoLogin 自动登录配置</strong></p> </li> 
 <li> <p>是否开启自动登录（<code>enableAutoLogin</code>）</p> </li> 
 <li> <p>自动登录参数名（<code>autoLoginParam</code>）</p> </li> 
 <li> <p>自动登录 Cookie 最大存储时间（<code>autoLoginMaxAge</code>）</p> </li> 
 <li> <p>自动登录 Cookie 的 path（<code>autoLoginPath</code>）</p> </li> 
 <li> <p>自动登录 Cookie 的 domain（<code>autoLoginDomain</code>）</p> </li> 
 <li> <p><strong>LockLogin 登录锁定</strong></p> </li> 
 <li> <p>是否开启登录锁定功能（<code>enableLockLogin</code>）</p> </li> 
 <li> <p>登录锁定使用的 Shiro EhCache 缓存管理器（<code>ehCacheManager</code>）</p> </li> 
 <li> <p>登录检测 EhCache 缓存名（<code>lockCheckCacheName</code>）</p> </li> 
 <li> <p>登录锁定 EhCache 缓存名（<code>lockLoginCacheName</code>）</p> </li> 
 <li> <p>用户名锁定达到的最大登录错误次数（<code>userLock</code>）</p> </li> 
 <li> <p>IP锁定达到的最大登录错误次数（<code>ipLock</code>）</p> </li> 
 <li> <p>基于IP的达到指定登录错误次数，显示验证码（<code>showCaptcha</code>）</p> </li> 
 <li> <p><strong>登录失败相关错误消息</strong></p> </li> 
 <li> <p>request 或 session 存储消息的名称（<code>msgKey</code>）</p> </li> 
 <li> <p>消息是否存入 session（<code>sessionMsg</code>）</p> </li> 
 <li> <p>消息是否存入 request（<code>requestMsg</code>）</p> </li> 
 <li> <p>异常消息 Map 定义（<code>exceptionMsg</code>），格式 <code>ExceptionSimpleClassName=Message</code></p> </li> 
 <li> <p><strong>EasyURLPermissionFilter</strong></p> </li> 
 <li> <p>是否开启登录超时检测（<code>authenticationTimeoutCheck</code>）</p> </li> 
 <li> <p>权限验证失败，Ajax 消息 key（<code>msg</code>）</p> </li> 
 <li> <p>权限验证失败，Ajax 状态码 key（<code>statusCode</code>）</p> </li> 
 <li> <p>将消息存入 session（<code>sessionMsg</code>）</p> </li> 
 <li> <p>将消息存入 request（<code>requestMsg</code>）</p> </li> 
 <li> <p>授权失败提示内容（<code>permissionDeniedMsg</code>）</p> </li> 
 <li> <p>登录超时提示内容（<code>authenticationTimeoutMsg</code>）</p> </li> 
</ul> 
<h4> <a id="32-spring-配置模板-spring-shiroxml" class="anchor" href="#32-spring-%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF-spring-shiroxml" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.2 Spring 配置模板 spring-shiro.xml</h4> 
<div class="highlight highlight-text-xml">
 <pre>&lt;?<span class="pl-ent">xml</span><span class="pl-e"> version</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>1.0<span class="pl-pds">&quot;</span></span><span class="pl-e"> encoding</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>UTF-8<span class="pl-pds">&quot;</span></span>?&gt;
&lt;<span class="pl-ent">beans</span> <span class="pl-e">xmlns</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>http://www.springframework.org/schema/beans<span class="pl-pds">&quot;</span></span>
	xmlns:xsi=<span class="pl-s"><span class="pl-pds">&quot;</span>http://www.w3.org/2001/XMLSchema-instance<span class="pl-pds">&quot;</span></span>
	xmlns:p=<span class="pl-s"><span class="pl-pds">&quot;</span>http://www.springframework.org/schema/p<span class="pl-pds">&quot;</span></span>
	xsi:schemaLocation=<span class="pl-s"><span class="pl-pds">&quot;</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="pl-pds">&quot;</span></span>&gt;
	

    <span class="pl-c"><span class="pl-c">&lt;!--</span> Session 过期验证移除 (DEFAULT) <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionValidationScheduler<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.session.mgt.ExecutorServiceSessionValidationScheduler<span class="pl-pds">&quot;</span></span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> Default is 3,600,000 millis = 1 hour <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>interval<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>3600000<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> Session DAO (DEFAULT) <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionDAO<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO<span class="pl-pds">&quot;</span></span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> This name matches a cache name in ehcache.xml <span class="pl-c">--&gt;</span></span>
        <span class="pl-c"><span class="pl-c">&lt;!--</span> &lt;property name=&quot;activeSessionsCacheName&quot; value=&quot;shiro-activeSessionsCache&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> Session Manager (DEFAULT)<span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.web.session.mgt.DefaultWebSessionManager<span class="pl-pds">&quot;</span></span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> Session Timeout: 3,600,000 milliseconds = 1 hour<span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>globalSessionTimeout<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>3600000<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt; 
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionValidationScheduler<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionValidationScheduler<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionValidationSchedulerEnabled<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionDAO<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionDAO<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> Cache: EhCache (DEFAULT)<span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>ehCacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.cache.ehcache.EhCacheManagerFactoryBean<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>configLocation<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>classpath:/ehcache.xml<span class="pl-pds">&quot;</span></span> /&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shared<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span> /&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    <span class="pl-c"><span class="pl-c">&lt;!--</span> </span>
<span class="pl-c">    	&lt;bean id=&quot;cacheManager&quot; class=&quot;org.springframework.cache.ehcache.EhCacheCacheManager&quot;&gt;</span>
<span class="pl-c">            &lt;property name=&quot;cacheManager&quot; ref=&quot;ehCacheManager&quot; /&gt;</span>
<span class="pl-c">        &lt;/bean&gt; </span>
<span class="pl-c">    	<span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroCacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.cache.ehcache.EhCacheManager<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>ehCacheManager<span class="pl-pds">&quot;</span></span> /&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> RememberMeManager (DEFAULT) <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cookie<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.web.servlet.SimpleCookie<span class="pl-pds">&quot;</span></span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> cookie name  <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rememberMe<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span>  default is /request.getContextPath() <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>path<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt; 
        <span class="pl-c"><span class="pl-c">&lt;!--</span> default is ONE_YEAR <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>maxAge<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>31536000<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt; 
    	&lt;/<span class="pl-ent">bean</span>&gt;
    	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rememberMeManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.web.mgt.CookieRememberMeManager<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cookie<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cookie<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;

	
    <span class="pl-c"><span class="pl-c">&lt;!--</span> EasyJdbcRealm  (**USER DEFINED**) <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>jdbcRealm<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyshiro.EasyJdbcRealm<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>dataSource<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>dataSource<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> 认证信息查询语句; default: select * from users where username = ? <span class="pl-c">--&gt;</span></span>
        <span class="pl-c"><span class="pl-c">&lt;!--</span> 用户状态：0启用; 1禁用; 2删除 <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>authenticationQuery<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>select * from users where username = ?<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> 密码列列名; default: password <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>passwordColumn<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>password<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> 角色查询语句(支持多个username=?); default: select role_name from user_roles where username = ?  <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>userRolesQuery<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>select role_name from user_roles where username = ?<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> 是否执行permissionsQuery权限查询; default: true <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>permissionsLookupEnabled<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> 权限查询语句(支持多个username=?); default: select permission from user_roles_permissions where username = ?&quot;  <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>permissionsQuery<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>select permission from user_roles_permissions where username = ?<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> EasyJdbcRealm 拦截器，可以认证和授权信息获得后，对SimpleAuthenticationInfo认证和SimpleAuthorizationInfo授权信息进行额外处理 <span class="pl-c">--&gt;</span></span>
        <span class="pl-c"><span class="pl-c">&lt;!--</span> </span>
<span class="pl-c">		&lt;property name=&quot;interceptor&quot; ref=&quot;realmInterceptor&quot;&gt;&lt;/property&gt; </span>
<span class="pl-c">		<span class="pl-c">--&gt;</span></span>
    &lt;/<span class="pl-ent">bean</span>&gt;
	
    <span class="pl-c"><span class="pl-c">&lt;!--</span> EasyShiro 自定义认证处理拦截器 (**USER DEFINED**)<span class="pl-c">--&gt;</span></span>
    <span class="pl-c"><span class="pl-c">&lt;!--</span> EasyFormAuthenticationFilter 认证成功或失败拦截器 <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>authenticationInterceptor<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyee.ssh.sys.shiro.AuthenticationInterceptor<span class="pl-pds">&quot;</span></span>&gt; &lt;/<span class="pl-ent">bean</span>&gt;
    <span class="pl-c"><span class="pl-c">&lt;!--</span> EasyJdbcRealm 认证与授权信息处理拦截器 <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>realmInterceptor<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyee.ssh.sys.shiro.RealmInterceptor<span class="pl-pds">&quot;</span></span>&gt; &lt;/<span class="pl-ent">bean</span>&gt;

    <span class="pl-c"><span class="pl-c">&lt;!--</span> auth Login Authentication (**USER DEFINED**)<span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>auth<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyshiro.EasyFormAuthenticationFilter<span class="pl-pds">&quot;</span></span>&gt;
    
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ FormAuthenticationFilter Configuration ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> when request method is post execute login, else to login page view <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>loginUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toLogin.action<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> redirect after successful login <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>successUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toMain.action<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> name of request parameter with username; if not present filter assumes 'username' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>usernameParam<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>name<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> name of request parameter with password; if not present filter assumes 'password' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>passwordParam<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>password<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> does the user wish to be remembered?; if not present filter assumes 'rememberMe' <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> &lt;property name=&quot;rememberMeParam&quot; value=&quot;rememberMe&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
         
         
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ EasyFormAuthenticationFilter Configuration ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ## Login Configuration ## <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span>  登录成功，将 token 存入 session 的 key; default is 'TOKEN' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionTokenKey<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>TOKEN<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 是否使用登录失败以重定向方式跳转回登录页面; default is 'false' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>loginFailureRedirectToLogin<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         
         
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ User defined UsernamePasswordToken Configuration ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 自定义 UsernamePasswordToken; Default is 'org.apache.shiro.auth.UsernamePasswordToken' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>tokenClassName<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyee.ssh.sys.shiro.UsernamePasswordEncodeToken<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         
         
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ CAPTCHA Configuration ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 是否开启验证码验证; default 'true' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>enableCaptcha<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 验证码参数名; default 'captcha' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>captchaParam<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>captcha<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> Session中存储验证码值的key; default 'captcha' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionCaptchaKey<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rand<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         
         
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ AutoLogin Configuration ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 是否开启自动登录 <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>enableAutoLogin<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>false<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 自动登录参数数名 <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>autoLoginParam<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>autoLogin<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> Cookie maxAge ，default is ONE_YEAR <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>autoLoginMaxAge<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>31536000<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> Cookie path，default is &quot;&quot; <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>autoLoginPath<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> Cookie domain，empty or default is your current domain name <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>autoLoginDomain<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span><span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         
         
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ LockLogin Configuration ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ##  ehcache.xml Configuration ## <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 管理锁定时间周期的 EHCache 缓存名称，只需调整timeToIdleSeconds <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 达到登录锁定次数，登录锁定  2 Hours <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> </span>
<span class="pl-c">     		 &lt;cache</span>
<span class="pl-c">                    name=&quot;shiro-lockLoginCache&quot;</span>
<span class="pl-c">                    maxElementsInMemory=&quot;100000&quot;</span>
<span class="pl-c">                    eternal=&quot;false&quot;</span>
<span class="pl-c">                    timeToIdleSeconds=&quot;0&quot;</span>
<span class="pl-c">                    timeToLiveSeconds=&quot;7200&quot;</span>
<span class="pl-c">                    diskExpiryThreadIntervalSeconds=&quot;600&quot;</span>
<span class="pl-c">                    memoryStoreEvictionPolicy=&quot;LRU&quot;</span>
<span class="pl-c">                    overflowToDisk=&quot;true&quot;</span>
<span class="pl-c">                    diskPersistent=&quot;true&quot; &gt;</span>
<span class="pl-c">              &lt;/cache&gt;</span>
<span class="pl-c">     		 <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 统计登录错误次数时间周期的 EHCache 缓存名称，只需调整timeToIdleSeconds <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 统计 10 分钟内的错误次数  <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> </span>
<span class="pl-c">      		 &lt;cache</span>
<span class="pl-c">                   name=&quot;shiro-lockCheckCache&quot;</span>
<span class="pl-c">                   maxElementsInMemory=&quot;100000&quot;</span>
<span class="pl-c">                   eternal=&quot;false&quot;</span>
<span class="pl-c">                   timeToIdleSeconds=&quot;0&quot;</span>
<span class="pl-c">                   timeToLiveSeconds=&quot;600&quot;</span>
<span class="pl-c">                   diskExpiryThreadIntervalSeconds=&quot;600&quot;</span>
<span class="pl-c">                   memoryStoreEvictionPolicy=&quot;LRU&quot;&gt;</span>
<span class="pl-c">                   &lt;persistence strategy=&quot;localTempSwap&quot;/&gt;</span>
<span class="pl-c">               &lt;/cache&gt; </span>
<span class="pl-c">      		 <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 是否开启LockLogin用户登录锁定；默认为false，不开启 <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>enableLockLogin<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>false<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> Shiro CacheManager <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>ehCacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroCacheManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 管理锁定时间周期的 EHCache 缓存名称；默认为 shiro-lockLoginCache <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>lockLoginCacheName<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiro-lockLoginCache<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 统计登录错误次数时间周期的 EHCache 缓存名称；默认为 shiro-lockCheckCache <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>lockCheckCacheName<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiro-lockCheckCache<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 同一用户名登录达到登录错误次数，登录锁定；0为不限制；默认为6 <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>userLock<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>4<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span>  同一IP登录达到错误次数，登录锁定；0为不限制；默认为15 <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>ipLock<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>6<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 达到指定登录错误次数，显示验证码；-1为不控制验证码显示；默认为1 <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>showCaptcha<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>4<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         
         <span class="pl-c"><span class="pl-c">&lt;!--</span> ************ 登录失败相关错误消息 ************ <span class="pl-c">--&gt;</span></span>
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 登录失败，消息 key  <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>msgKey<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>MSG<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 将消息存入session，session.setAttribute(MsgKey,xxxErrorMsg); default is 'false' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> 将消息存入request，request.setAttribute(MsgKey,xxxErrorMsg); default is 'false' <span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>requestMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
         <span class="pl-c"><span class="pl-c">&lt;!--</span> # 登录错误的，异常提示内容 Map<span class="pl-c">--&gt;</span></span>
         &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>exceptionMsg<span class="pl-pds">&quot;</span></span>&gt;
             &lt;<span class="pl-ent">map</span>&gt;
                 <span class="pl-c"><span class="pl-c">&lt;!--</span> ExceptionClassName:&quot;Message&quot;, ExceptionClassName2:&quot;Message2&quot;, ... <span class="pl-c">--&gt;</span></span>
                 &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>LockedAccountException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>账户锁定，请联系管理员解锁。<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
                 
                 &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>AuthenticationException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>用户名或密码有误！<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
                 
                 &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>EasyIncorrectCaptchaException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>验证码有误！<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
                 &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>EasyLockUserException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>由于该用户连续登录错误，暂时被锁定 2 小时，请稍后再试。<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
                 &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>EasyLockIPException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>由于该IP连续登录错误，暂时被锁定 2 小时，请稍后再试。<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
             &lt;/<span class="pl-ent">map</span>&gt;
         &lt;/<span class="pl-ent">property</span>&gt;
     	
     	<span class="pl-c"><span class="pl-c">&lt;!--</span> ************自定义拦截器，实现 EasyAuthenticationInterceptor 接口************ <span class="pl-c">--&gt;</span></span>
     	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>interceptor<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>authenticationInterceptor<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> specify LogoutFilter  (**USER DEFINED**) <span class="pl-c">--&gt;</span></span>
    <span class="pl-c"><span class="pl-c">&lt;!--</span> 能够实现会话安全信息(Subjec/Session)，RememberMe信息和AutoLogin自动登录信息的注销 <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>logout<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyshiro.EasyLogoutFilter<span class="pl-pds">&quot;</span></span>&gt;
    	<span class="pl-c"><span class="pl-c">&lt;!--</span> specify logout redirectUrl <span class="pl-c">--&gt;</span></span>
    	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redirectUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toLogin.action<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    	<span class="pl-c"><span class="pl-c">&lt;!--</span> EasyFormAuthenticationFilter <span class="pl-c">--&gt;</span></span>
    	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>easyFormAuthenticationFilter<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>auth<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> perms  (**USER DEFINED**) <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>perms<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.easyshiro.EasyURLPermissionFilter<span class="pl-pds">&quot;</span></span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 权限验证失败，转向的url <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>unauthorizedUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toLogin.action<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 是否开启登录超时检测; default is 'true'<span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>authenticationTimeoutCheck<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 权限验证失败，消息 key; default is 'MSG'  <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>msgKey<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>msg<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 权限验证失败，状态码 key：301，登录超时; 401，权限拒绝; default is 'statusCode'  <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>statusCode<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>statusCode<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 将消息存入session，session.setAttribute(MsgKey,xxxErrorMsg); default is 'false' <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 将消息存入request，request.setAttribute(MsgKey,xxxErrorMsg); default is 'false' <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>requestMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 认证失败提示内容;  default is 'Permission denied!' <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>permissionDeniedMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>您没有权限<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> 登录超时提示内容; default is 'Your login has expired, please login again!' <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>authenticationTimeoutMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>您的登录已过期，请重新登录！<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> Shiro Native SessionManager (DEFAULT)<span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>securityManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.web.mgt.DefaultWebSecurityManager<span class="pl-pds">&quot;</span></span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> &lt;property name=&quot;sessionMode&quot; value=&quot;native&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	<span class="pl-c"><span class="pl-c">&lt;!--</span> Cache: EhCache<span class="pl-c">--&gt;</span></span>
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroCacheManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rememberMeManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rememberMeManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
        	&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>realms<span class="pl-pds">&quot;</span></span>&gt;
        		&lt;<span class="pl-ent">list</span>&gt;
        			&lt;<span class="pl-ent">ref</span> <span class="pl-e">bean</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>jdbcRealm<span class="pl-pds">&quot;</span></span>/&gt;
        		&lt;/<span class="pl-ent">list</span>&gt;
        	&lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> shiroFilter  (**USER DEFINED**) <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroFilter<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.spring.web.ShiroFilterFactoryBean<span class="pl-pds">&quot;</span></span>&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>securityManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>securityManager<span class="pl-pds">&quot;</span></span>/&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> override these for application-specific URLs if you like:<span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>loginUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toLogin.action<span class="pl-pds">&quot;</span></span>/&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>successUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toMain.action<span class="pl-pds">&quot;</span></span>/&gt;
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>unauthorizedUrl<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>/toLogin.action<span class="pl-pds">&quot;</span></span>/&gt; 
        &lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>filterChainDefinitions<span class="pl-pds">&quot;</span></span>&gt;
            &lt;<span class="pl-ent">value</span>&gt;
                # anonymous
    			/checkCaptcha.action = anon
    			/notFound.action = anon
    			
                # requests to /DoLogout will be handled by the ‘logout’ filter
    			/logout.action = logout
    			
    			# requests to /toLogin.action will be handled by the ‘auth’ filter
    			/toLogin.action = auth
    			
    			# doc page need auth
    			/doc/** = auth
    			
    			# need to permission
    			/toMain.action = auth
    			/*.action =  perms
            &lt;/<span class="pl-ent">value</span>&gt;
        &lt;/<span class="pl-ent">property</span>&gt;
    &lt;/<span class="pl-ent">bean</span>&gt;
    
    <span class="pl-c"><span class="pl-c">&lt;!--</span> DEFAULT <span class="pl-c">--&gt;</span></span>
    &lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>lifecycleBeanPostProcessor<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.spring.LifecycleBeanPostProcessor<span class="pl-pds">&quot;</span></span>/&gt;   	
&lt;/<span class="pl-ent">beans</span>&gt;</pre>
</div> 
<h4> <a id="32-shiro-ini-配置模板-shiroini" class="anchor" href="#32-shiro-ini-%E9%85%8D%E7%BD%AE%E6%A8%A1%E6%9D%BF-shiroini" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3.2 Shiro INI 配置模板 shiro.ini</h4> 
<div class="highlight highlight-source-ini">
 <pre><span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-c"><span class="pl-c">#</span> Users and their (optional) assigned roles</span>
<span class="pl-c"><span class="pl-c">#</span> username = password, role1, role2, ..., roleN</span>
<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-en">[users]</span>
<span class="pl-c"><span class="pl-c">#</span>admin = admin123, admin</span>
<span class="pl-c"><span class="pl-c">#</span>jay = 123, user</span>
<span class="pl-c"><span class="pl-c">#</span>guest = guest, guest</span>

<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-c"><span class="pl-c">#</span> Roles with assigned permissions</span>
<span class="pl-c"><span class="pl-c">#</span> roleName = perm1, perm2, ..., permN</span>
<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-en">[roles]</span>
<span class="pl-c"><span class="pl-c">#</span>admin = *</span>
<span class="pl-c"><span class="pl-c">#</span>user = log:*</span>


<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-c"><span class="pl-c">#</span> Configuration SessionManager, Cache, Filter</span>
<span class="pl-c"><span class="pl-c">#</span> myFilter = com.company.web.some.FilterImplementation</span>
<span class="pl-c"><span class="pl-c">#</span> myFilter.property1 = value1</span>
<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>

<span class="pl-en">[main]</span>
<span class="pl-c"><span class="pl-c">#</span>- Session Manager</span>
<span class="pl-c"><span class="pl-c">#</span> securityManager.sessionManager.xxxx=xxxx</span>

<span class="pl-c"><span class="pl-c">#</span>-- Shiro Native SessionManager (DEFAULT)</span>
<span class="pl-k">sessionManager</span> = org.apache.shiro.web.session.mgt.DefaultWebSessionManager
<span class="pl-c"><span class="pl-c">#</span> Use the configured native session manager:</span>
<span class="pl-k">securityManager.sessionManager</span> = $sessionManager

<span class="pl-c"><span class="pl-c">#</span>-- Session Timeout (DEFAULT)</span>
<span class="pl-c"><span class="pl-c">#</span> 3,600,000 milliseconds = 1 hour</span>
<span class="pl-k">securityManager.sessionManager.globalSessionTimeout</span> = 3600000

<span class="pl-c"><span class="pl-c">#</span>-- Session Listeners</span>
<span class="pl-c"><span class="pl-c">#</span> implement the SessionListener interface (or extend the convenience SessionListenerAdapter) </span>
<span class="pl-c"><span class="pl-c">#</span> As the default SessionManager sessionListeners property is a collection, you can configure the SessionManager with one or more of your listener implementations like any other collection in shiro.ini:</span>
<span class="pl-c"><span class="pl-c">#</span>aSessionListener = com.foo.my.SessionListener</span>
<span class="pl-c"><span class="pl-c">#</span>anotherSessionListener = com.foo.my.OtherSessionListener</span>
<span class="pl-c"><span class="pl-c">#</span>securityManager.sessionManager.sessionListeners = $aSessionListener, $anotherSessionListener, etc.</span>


<span class="pl-c"><span class="pl-c">#</span>-- Custom Session IDs</span>
<span class="pl-c"><span class="pl-c">#</span> The default SessionIdGenerator is a JavaUuidSessionIdGenerator, </span>
<span class="pl-c"><span class="pl-c">#</span> which generates String IDs based on Java UUIDs. </span>
<span class="pl-c"><span class="pl-c">#</span>sessionIdGenerator = com.my.session.SessionIdGenerator</span>
<span class="pl-c"><span class="pl-c">#</span>securityManager.sessionManager.sessionDAO.sessionIdGenerator = $sessionIdGenerator</span>


<span class="pl-c"><span class="pl-c">#</span>-- SessionValidationScheduler (DEFAULT)</span>
<span class="pl-c"><span class="pl-c">#</span> Sessions are only validated to see </span>
<span class="pl-c"><span class="pl-c">#</span> if they have been stopped or expired at the time they are accessed, </span>
<span class="pl-c"><span class="pl-c">#</span> A SessionValidationScheduler is responsible for validating sessions </span>
<span class="pl-c"><span class="pl-c">#</span> at a periodic rate to ensure they are cleaned up as necessary.</span>
<span class="pl-c"><span class="pl-c">#</span> You can custom SessionValidationScheduler implementation class.</span>
<span class="pl-k">sessionValidationScheduler</span> = org.apache.shiro.session.mgt.ExecutorServiceSessionValidationScheduler
<span class="pl-c"><span class="pl-c">#</span> Default is 3,600,000 millis = 1 hour:</span>
<span class="pl-k">sessionValidationScheduler.interval</span> = 3600000
<span class="pl-k">securityManager.sessionManager.sessionValidationScheduler</span> = $sessionValidationScheduler
<span class="pl-c"><span class="pl-c">#</span>securityManager.sessionManager.sessionValidationSchedulerEnabled = false</span>


<span class="pl-c"><span class="pl-c">#</span>-- Session DAO (DEFAULT)</span>
<span class="pl-c"><span class="pl-c">#</span> cache in the CacheManager should be used to store active sessions:</span>
<span class="pl-k">sessionDAO</span> = org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO
<span class="pl-k">securityManager.sessionManager.sessionDAO</span> = $sessionDAO
<span class="pl-c"><span class="pl-c">#</span> By default, the EnterpriseCacheSessionDAO asks the CacheManager </span>
<span class="pl-c"><span class="pl-c">#</span> for a Cache named &quot;shiro-activeSessionCache&quot;</span>
<span class="pl-c"><span class="pl-c">#</span>sessionDAO.activeSessionsCacheName = ehcache_region_name</span>


<span class="pl-c"><span class="pl-c">#</span>- Cache</span>
<span class="pl-c"><span class="pl-c">#</span> securityManager.cacheManager</span>

<span class="pl-c"><span class="pl-c">#</span>-- EhCache (DEFAULT)</span>
<span class="pl-k">cacheManager</span> = org.apache.shiro.cache.ehcache.EhCacheManager
<span class="pl-k">cacheManager.cacheManagerConfigFile</span> = classpath:ehcache.xml
<span class="pl-c"><span class="pl-c">#</span>#-- in-memory-only Cache</span>
<span class="pl-c"><span class="pl-c">#</span>cacheManager = org.apache.shiro.cache.MemoryConstrainedCacheManager</span>
<span class="pl-k">securityManager.cacheManager</span> = $cacheManager

<span class="pl-c"><span class="pl-c">#</span>- RememeberMe(org.apache.shiro.web.mgt.CookieRememberMeManager) (DEFAULT)</span>
<span class="pl-k">securityManager.rememberMeManager.cookie.name</span> = rememberMe
<span class="pl-c"><span class="pl-c">#</span> default is /request.getContextPath()</span>
<span class="pl-k">securityManager.rememberMeManager.cookie.path</span> = /
<span class="pl-c"><span class="pl-c">#</span> default is ONE_YEAR</span>
<span class="pl-k">securityManager.rememberMeManager.cookie.maxAge</span> = 31536000


<span class="pl-c"><span class="pl-c">#</span>------------------------------ When use Session Clustering: Ehcache + Terracotta </span>
<span class="pl-c"><span class="pl-c">#</span>sessionDAO = org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO</span>
<span class="pl-c"><span class="pl-c">#</span># This name matches a cache name in ehcache.xml:</span>
<span class="pl-c"><span class="pl-c">#</span>sessionDAO.activeSessionsCacheName = shiro-activeSessionsCache</span>
<span class="pl-c"><span class="pl-c">#</span>securityManager.sessionManager.sessionDAO = $sessionDAO</span>
<span class="pl-c"><span class="pl-c">#</span></span>
<span class="pl-c"><span class="pl-c">#</span># Configure The EhCacheManager:</span>
<span class="pl-c"><span class="pl-c">#</span>cacheManager = org.apache.shiro.cache.ehcache.EhCacheManager</span>
<span class="pl-c"><span class="pl-c">#</span>cacheManager.cacheManagerConfigFile = classpath:ehcache.xml</span>
<span class="pl-c"><span class="pl-c">#</span></span>
<span class="pl-c"><span class="pl-c">#</span># Configure the above CacheManager on Shiro's SecurityManager</span>
<span class="pl-c"><span class="pl-c">#</span># to use it for all of Shiro's caching needs:</span>
<span class="pl-c"><span class="pl-c">#</span>securityManager.cacheManager = $cacheManager</span>
<span class="pl-c"><span class="pl-c">#</span>------------------------------ When use Session Clustering: Ehcache + Terracotta</span>

<span class="pl-c"><span class="pl-c">#</span>- Realm</span>

<span class="pl-c"><span class="pl-c">#</span>-- DataSource (**USER DEFINED**) </span>
<span class="pl-k">dataSource</span>=com.alibaba.druid.pool.DruidDataSource  
<span class="pl-k">dataSource.url</span>=jdbc:mysql://127.0.0.1:3306/easyssh
<span class="pl-k">dataSource.username</span>=root  
<span class="pl-k">dataSource.password</span>=root  
<span class="pl-k">dataSource.initialSize</span>=1
<span class="pl-k">dataSource.minIdle</span>=1 
<span class="pl-k">dataSource.maxActive</span>=20
<span class="pl-k">dataSource.maxWait</span>=60000
<span class="pl-k">dataSource.timeBetweenEvictionRunsMillis</span>=60000
<span class="pl-k">dataSource.minEvictableIdleTimeMillis</span>=300000
<span class="pl-k">dataSource.validationQuery</span>=SELECT <span class="pl-s"><span class="pl-pds">'</span>x<span class="pl-pds">'</span></span>
<span class="pl-k">dataSource.testWhileIdle</span>=true
<span class="pl-k">dataSource.testOnBorrow</span>=false
<span class="pl-k">dataSource.testOnReturn</span>=false
<span class="pl-k">dataSource.poolPreparedStatements</span>=false
<span class="pl-k">dataSource.maxPoolPreparedStatementPerConnectionSize</span>=20


<span class="pl-c"><span class="pl-c">#</span>-- EasyJdbcRealm (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span>jdbcRealm=org.apache.shiro.realm.jdbc.JdbcRealm</span>
<span class="pl-k">jdbcRealm</span>=cn.easyproject.easyshiro.EasyJdbcRealm
<span class="pl-k">jdbcRealm.dataSource</span>=$dataSource  
<span class="pl-c"><span class="pl-c">#</span> 认证信息查询语句; default: select * from users where username = ?</span>
<span class="pl-k">jdbcRealm.authenticationQuery</span>=select user_id as userid,name,password,status,real_name as realname from sys_user where <span class="pl-k">name</span>=? and status in(0,1)
<span class="pl-c"><span class="pl-c">#</span> 密码列列名; default: password</span>
<span class="pl-k">jdbcRealm.passwordColumn</span>=password
<span class="pl-c"><span class="pl-c">#</span> 角色查询语句(支持多个username=?); default: select role_name from user_roles where username = ? </span>
<span class="pl-k">jdbcRealm.userRolesQuery</span>=select name from sys_role where role_id in (select role_id from sys_user_role where <span class="pl-k">user_id</span>=(select user_id from sys_user where <span class="pl-k">name</span>=?)) and <span class="pl-k">status</span>=0 
<span class="pl-c"><span class="pl-c">#</span> 是否执行permissionsQuery权限查询; default: true</span>
<span class="pl-k">jdbcRealm.permissionsLookupEnabled</span>=true
<span class="pl-c"><span class="pl-c">#</span> 权限查询语句(支持多个username=?); default: select permission from roles_permissions where role_name = ?&quot; </span>
<span class="pl-k">jdbcRealm.permissionsQuery</span>=select action from sys_menu_permission where MENU_PERMISSION_ID in( select MENU_PERMISSION_ID from sys_role_menu_permission where ROLE_ID in(select role_id from sys_user_role where <span class="pl-k">user_id</span>=(select user_id from sys_user where <span class="pl-k">name</span>=?))) UNION select action from sys_operation_permission where OPERATION_PERMISSION_ID in(select OPERATION_PERMISSION_ID from sys_role_operation_permission where ROLE_ID in(select role_id from sys_user_role where <span class="pl-k">user_id</span>=(select user_id from sys_user where <span class="pl-k">name</span>=?)))  
<span class="pl-c"><span class="pl-c">#</span> EasyJdbcRealm 拦截器，可以认证和授权信息获得后，对SimpleAuthenticationInfo认证和SimpleAuthorizationInfo授权信息进行额外处理</span>
<span class="pl-k">jdbcRealm.interceptor</span>=$realmInterceptor
<span class="pl-c"><span class="pl-c">#</span> 自定义 EasyJdbcRealm 拦截器，可以认证和授权信息获得后，对SimpleAuthenticationInfo认证和SimpleAuthorizationInfo授权信息进行额外处理</span>
<span class="pl-k">realmInterceptor</span>=cn.easyproject.easyee.ssh.sys.shiro.RealmInterceptor
<span class="pl-k">jdbcRealm.interceptor</span>=$realmInterceptor

<span class="pl-k">securityManager.realms</span>=$jdbcRealm 


<span class="pl-c"><span class="pl-c">#</span>- auth Login Authentication (**USER DEFINED**) </span>

<span class="pl-c"><span class="pl-c">#</span>-- 自定义 auth</span>
<span class="pl-c"><span class="pl-c">#</span>auth=cn.easyproject.easyshiro.EasyFormAuthenticationFilter</span>
<span class="pl-k">auth</span>=cn.easyproject.easyshiro.EasyFormAuthenticationFilter
<span class="pl-c"><span class="pl-c">#</span> specify login form page</span>
<span class="pl-c"><span class="pl-c">#</span> when request method is post execute login, else to login page view</span>
<span class="pl-k">auth.loginUrl</span> = /toLogin.action
<span class="pl-c"><span class="pl-c">#</span> redirect after successful login</span>
<span class="pl-k">auth.successUrl</span> = /toMain.action
<span class="pl-c"><span class="pl-c">#</span> name of request parameter with username; if not present filter assumes 'username'</span>
<span class="pl-k">auth.usernameParam</span> = name
<span class="pl-c"><span class="pl-c">#</span> name of request parameter with password; if not present filter assumes 'password'</span>
<span class="pl-k">auth.passwordParam</span> = password
<span class="pl-c"><span class="pl-c">#</span> does the user wish to be remembered?; if not present filter assumes 'rememberMe'</span>
<span class="pl-k">auth.rememberMeParam</span> = rememberMe

<span class="pl-c"><span class="pl-c">#</span>-- EasyFormAuthenticationFilter 自定义扩展属性 (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span>---- Login Configuration</span>
<span class="pl-c"><span class="pl-c">#</span> 登录成功，将 token 存入 session 的 key; default is 'TOKEN'</span>
<span class="pl-c"><span class="pl-c">#</span> session.setAttribute(sessionTokenName,tokenObject); </span>
<span class="pl-k">auth.sessionTokenKey</span>= TOKEN
<span class="pl-c"><span class="pl-c">#</span> 是否使用登录失败以重定向方式跳转回登录页面; default is 'false'</span>
<span class="pl-k">auth.loginFailureRedirectToLogin</span> = true

<span class="pl-c"><span class="pl-c">#</span>---- User defined UsernamePasswordToken Configuration (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> 自定义 UsernamePasswordToken; Default is 'org.apache.shiro.auth.UsernamePasswordToken'</span>
<span class="pl-k">auth.tokenClassName</span>=cn.easyproject.easyee.ssh.sys.shiro.UsernamePasswordEncodeToken

<span class="pl-c"><span class="pl-c">#</span>---- CAPTCHA Configuration (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> 是否开启验证码; default 'true'</span>
<span class="pl-k">auth.enableCaptcha</span>=true
<span class="pl-c"><span class="pl-c">#</span> 验证码参数名; default 'captcha'</span>
<span class="pl-k">auth.captchaParam</span> = captcha
<span class="pl-c"><span class="pl-c">#</span> Session中存储验证码值得可以; default 'captcha'</span>
<span class="pl-k">auth.sessionCaptchaKey</span> = rand


<span class="pl-c"><span class="pl-c">#</span>---------  AutoLogin Configuration  (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> 是否开启自动登录 </span>
<span class="pl-k">auth.enableAutoLogin</span>=false
<span class="pl-c"><span class="pl-c">#</span> 自动登录参数数名 </span>
<span class="pl-k">auth.autoLoginParam</span>=autoLogin
<span class="pl-c"><span class="pl-c">#</span> Cookie maxAge ，default is ONE_YEAR </span>
<span class="pl-k">auth.autoLoginMaxAge</span>=31536000
<span class="pl-c"><span class="pl-c">#</span> Cookie path，default is &quot;&quot; </span>
<span class="pl-k">auth.autoLoginPath</span>=/
<span class="pl-c"><span class="pl-c">#</span> Cookie domain，empty or default is your current domain name </span>
<span class="pl-c"><span class="pl-c">#</span>auth.autoLoginDomain=</span>

<span class="pl-c"><span class="pl-c">#</span>---- LockLogin Configuration 登录失败相关错误消息 (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> 是否开启LockLogin用户登录锁定；默认为false，不开启</span>
<span class="pl-k">auth.enableLockLogin</span>=false
<span class="pl-c"><span class="pl-c">#</span> Shiro CacheManager </span>
<span class="pl-k">auth.ehCacheManager</span>=$cacheManager
<span class="pl-c"><span class="pl-c">#</span> LockLogin 管理锁定时间周期的 EHCache 缓存名称；默认为 shiro-lockLoginCache</span>
<span class="pl-k">auth.lockLoginCacheName</span>=shiro-lockLoginCache
<span class="pl-c"><span class="pl-c">#</span> LockLogin 统计登录错误次数时间周期的 EHCache 缓存名称；默认为 shiro-lockCheckCache </span>
<span class="pl-k">auth.lockCheckCacheName</span>=shiro-lockCheckCache
<span class="pl-c"><span class="pl-c">#</span> 同一用户名登录达到登录错误次数，登录锁定；0为不限制；默认为6 </span>
<span class="pl-k">auth.userLock</span>=4
<span class="pl-c"><span class="pl-c">#</span>  同一IP登录达到错误次数，登录锁定；0为不限制；默认为15 </span>
<span class="pl-k">auth.ipLock</span>=6
<span class="pl-c"><span class="pl-c">#</span> 达到指定登录错误次数，显示验证码；-1为不控制验证码显示；默认为1 </span>
<span class="pl-k">auth.showCaptcha</span>=2



<span class="pl-c"><span class="pl-c">#</span>---- 登录失败相关错误消息 (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> 登录失败，消息 key </span>
<span class="pl-k">auth.msgKey</span> = MSG
<span class="pl-c"><span class="pl-c">#</span> 将消息存入session，session.setAttribute(MsgKey,xxxErrorMsg); default is 'false'</span>
<span class="pl-k">auth.sessionMsg</span> = true
<span class="pl-c"><span class="pl-c">#</span> 将消息存入request，request.setAttribute(MsgKey,xxxErrorMsg); default is 'false'</span>
<span class="pl-k">auth.requestMsg</span> = true
<span class="pl-c"><span class="pl-c">#</span> 登录错误的，异常提示内容 Map</span>
<span class="pl-c"><span class="pl-c">#</span> ExceptionClassName:&quot;Message&quot;, ExceptionClassName2:&quot;Message2&quot;, ...</span>
<span class="pl-k">auth.exceptionMsg</span> = LockedAccountException:<span class="pl-s"><span class="pl-pds">&quot;</span>账户锁定，请联系管理员解锁。<span class="pl-pds">&quot;</span></span>, AuthenticationException:<span class="pl-s"><span class="pl-pds">&quot;</span>用户名，或密码有误！<span class="pl-pds">&quot;</span></span>, EasyIncorrectCaptchaException:<span class="pl-s"><span class="pl-pds">&quot;</span>验证码有误！<span class="pl-pds">&quot;</span></span>, EasyLockUserException:<span class="pl-s"><span class="pl-pds">&quot;</span>由于该用户连续登录错误，暂时被锁定 2 小时，请稍后再试。<span class="pl-pds">&quot;</span></span>, EasyLockIPException:<span class="pl-s"><span class="pl-pds">&quot;</span>由于该IP连续登录错误，暂时被锁定 2 小时，请稍后再试。<span class="pl-pds">&quot;</span></span>


<span class="pl-c"><span class="pl-c">#</span>---- 自定义 EasyJdbcRealmInterceptor 拦截器，可以在认证成功或失败后进行自定义代码处理 (**USER DEFINED**) </span>
<span class="pl-k">authenticationInterceptor</span>=cn.easyproject.easyee.ssh.sys.shiro.AuthenticationInterceptor
<span class="pl-k">auth.interceptor</span>=$authenticationInterceptor

<span class="pl-c"><span class="pl-c">#</span>- user Authentication (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> user filter, if not remeberMe redirected to the url, default is '/login.jsp'</span>
<span class="pl-k">user.loginUrl</span>=/login.jsp


<span class="pl-c"><span class="pl-c">#</span>- Logout (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> specify LogoutFilter</span>
<span class="pl-c"><span class="pl-c">#</span> logout = org.apache.shiro.web.filter.authc.LogoutFilter</span>
<span class="pl-c"><span class="pl-c">#</span> specify logout redirectUrl</span>
<span class="pl-k">logout</span>=cn.easyproject.easyshiro.EasyLogoutFilter
<span class="pl-k">logout.redirectUrl</span> = /login.jsp
<span class="pl-c"><span class="pl-c">#</span> EasyFormAuthenticationFilter</span>
<span class="pl-k">logout.easyFormAuthenticationFilter</span>=$auth


<span class="pl-c"><span class="pl-c">#</span>- perms  (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span># 自定义基于 URL规则 授权过滤器</span>
<span class="pl-k">perms</span>=cn.easyproject.easyshiro.EasyURLPermissionFilter
<span class="pl-c"><span class="pl-c">#</span> 权限验证失败，转向的url</span>
<span class="pl-k">perms.unauthorizedUrl</span>=/login.jsp
<span class="pl-c"><span class="pl-c">#</span> 是否开启登录超时检测; default is 'true'</span>
<span class="pl-k">perms.authenticationTimeoutCheck</span>= true

<span class="pl-c"><span class="pl-c">#</span># 权限验证失败相关错误消息 (**USER DEFINED**) </span>
<span class="pl-c"><span class="pl-c">#</span> 权限验证失败，消息 key; default is 'msg' </span>
<span class="pl-k">perms.msgKey</span> = msg
<span class="pl-c"><span class="pl-c">#</span> 权限验证失败，状态码 key：301，登录超时; 401，权限拒绝; default is 'statusCode' </span>
<span class="pl-k">perms.statusCode</span> = statusCode
<span class="pl-c"><span class="pl-c">#</span> 将消息存入session，session.setAttribute(MsgKey,xxxErrorMsg); default is 'false'</span>
<span class="pl-k">perms.sessionMsg</span> = true
<span class="pl-c"><span class="pl-c">#</span> 将消息存入request，request.setAttribute(MsgKey,xxxErrorMsg); default is 'false'</span>
<span class="pl-k">perms.requestMsg</span> = true
<span class="pl-c"><span class="pl-c">#</span> 认证失败提示内容;  default is 'Permission denied!'</span>
<span class="pl-k">perms.permissionDeniedMsg</span> = 您没有权限！
<span class="pl-c"><span class="pl-c">#</span> 登录超时提示内容; default is 'Your login has expired, please login again!'</span>
<span class="pl-k">perms.authenticationTimeoutMsg</span> = 您的登录已过期，请重新登录！

<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-c"><span class="pl-c">#</span> Urls and their filter</span>
<span class="pl-c"><span class="pl-c">#</span> URL_Ant_Path_Expression = Path_Specific_Filter_Chain</span>
<span class="pl-c"><span class="pl-c">#</span> filter1[optional_config1], filter2[optional_config2], ..., filterN[optional_configN]</span>
<span class="pl-c"><span class="pl-c">#</span> -----------------------------------------------------------------------------</span>
<span class="pl-en">[urls]</span>  (**USER DEFINED**) 
 <span class="pl-c"><span class="pl-c">#</span> anonymous</span>
/<span class="pl-k">checkCaptcha.action</span> = anon
/<span class="pl-k">notFound.action</span> = anon

<span class="pl-c"><span class="pl-c">#</span> requests to /DoLogout will be handled by the ‘logout’ filter</span>
/<span class="pl-k">logout.action</span> = logout

<span class="pl-c"><span class="pl-c">#</span> requests to /toLogin.action will be handled by the ‘auth’ filter</span>
/<span class="pl-k">toLogin.action</span> = auth

<span class="pl-c"><span class="pl-c">#</span> doc page need auth</span>
/doc/** = auth

<span class="pl-c"><span class="pl-c">#</span> need to permission</span>
/<span class="pl-k">toMain.action</span> = auth
/*.<span class="pl-k">action</span> =  perms</pre>
</div> 
<h2> <a id="组件详细功能" class="anchor" href="#%E7%BB%84%E4%BB%B6%E8%AF%A6%E7%BB%86%E5%8A%9F%E8%83%BD" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>组件详细功能</h2> 
<h4> <a id="1-easyformauthenticationfilter功能全面的表单登录认证过滤器扩展了-formauthenticationfilter" class="anchor" href="#1-easyformauthenticationfilter%E5%8A%9F%E8%83%BD%E5%85%A8%E9%9D%A2%E7%9A%84%E8%A1%A8%E5%8D%95%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81%E8%BF%87%E6%BB%A4%E5%99%A8%E6%89%A9%E5%B1%95%E4%BA%86-formauthenticationfilter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. EasyFormAuthenticationFilter：功能全面的表单登录认证过滤器，扩展了 <code>FormAuthenticationFilter</code>。</h4> 
<ul> 
 <li> <p>登录成功 Token 存入Session</p> </li> 
 <li> <p>重定向跳转支持（避免登录成功或失败后，刷新导致的重复提交无效登录请求）</p> </li> 
 <li> <p>登录异常消息的配置支持（为不同异常自定义错误提示消息，并将错误信息保存到 request 和 session（重定向时）作用域）</p> </li> 
 <li> <p>CAPTCHA 验证码支持</p> </li> 
 <li> <p>AutoLogin 自动登录支持</p> </li> 
 <li> <p>LockLogin 登录锁定支持</p> </li> 
 <li> <p><code>EasyAuthenticationInterceptor</code> 认证成功与失败拦截器支持（例如，可以在认证成功后进行用户锁定检测，或进行菜单查询初始化等扩展工作。）</p> </li> 
 <li> <p>已登陆用户重新登录账户（Shrio默认一个浏览器已登录情况下，登陆新账户会自动跳转到原登录页面）</p> </li> 
 <li> <p>继承的 RememberMe 支持（使用内置 user 过滤器实现，Shiro默认的 RememberMe 不是用来自动登录，而是用于 user 过滤器）</p> </li> 
</ul> 
<h4> <a id="2-easylogoutfilter-用户注销过滤器扩展了-logoutfilter" class="anchor" href="#2-easylogoutfilter-%E7%94%A8%E6%88%B7%E6%B3%A8%E9%94%80%E8%BF%87%E6%BB%A4%E5%99%A8%E6%89%A9%E5%B1%95%E4%BA%86-logoutfilter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. EasyLogoutFilter： 用户注销过滤器，扩展了 <code>LogoutFilter</code>。</h4> 
<ul> 
 <li>能够实现会话安全信息(Subjec/Session)，RememberMe信息和AutoLogin自动登录信息的注销。</li> 
</ul> 
<h4> <a id="3-easyusernamepasswordendcodetoken简化并方案更加灵活的密码加密token扩展了-usernamepasswordtoken" class="anchor" href="#3-easyusernamepasswordendcodetoken%E7%AE%80%E5%8C%96%E5%B9%B6%E6%96%B9%E6%A1%88%E6%9B%B4%E5%8A%A0%E7%81%B5%E6%B4%BB%E7%9A%84%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86token%E6%89%A9%E5%B1%95%E4%BA%86-usernamepasswordtoken" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. EasyUsernamePasswordEndcodeToken：简化并方案更加灵活的密码加密Token，扩展了 <code>UsernamePasswordToken</code>。</h4> 
<ul> 
 <li> <p>简化了登录时的密码加密处理，只需继承 <code>EasyUsernamePasswordEndcodeToken</code>，自行实现 <code>encodePassword()</code> 密码加密逻辑，即可返回密码加密后的结果</p> </li> 
 <li> <p>能够添自定义属性，使用 <code>EasyJdbcRealm</code> 登录认证时，自动将登录查询语句相关的用户数据库列值赋值给类的同名属性（<code>encodePassword()</code>加密时可以使用数据库列属性作为加密 <code>salt</code>）</p> </li> 
</ul> 
<h4> <a id="4-easyjdbcrealm通用的数据库认证角色权限查询realm扩展了-authorizingrealm" class="anchor" href="#4-easyjdbcrealm%E9%80%9A%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%A4%E8%AF%81%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E6%9F%A5%E8%AF%A2realm%E6%89%A9%E5%B1%95%E4%BA%86-authorizingrealm" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. EasyJdbcRealm：通用的数据库认证，角色，权限查询Realm，扩展了 <code>AuthorizingRealm</code>。</h4> 
<ul> 
 <li> <p>在 <code>doGetAuthenticationInfo</code> 用户登录认证时，能将查询语句查询的用户在数据库的信息，全部自动初始化到登录认证 Token <code>UsernamePasswordToken</code> 子类的扩展同名属性中，解决了认证信息不包含数据库用户属性的问题</p> </li> 
 <li> <p>提供了静态的 <code>reloadPermissions</code> 方法，<strong>可以在认证成功后直接刷新权限</strong>（例如：重新分配用户权限后，刷新当前用户的最新权限。）</p> </li> 
 <li> <p><code>EasyJdbcRealmInterceptor</code> 认证与授权信息拦截器（例如，可以在获取授权或认证信息后，对进行二次处理，如对特定字符分割的权限字符串进行分割后重新存入 <code>StringPermissions</code> 等等。）</p> </li> 
 <li> <p>兼容 <code>UsernamePasswordToken</code> 和 <code>EasyUsernamePasswordEndcodeToken</code> 的登录认证</p> </li> 
 <li> <p>提供EasyJdbcRealm，扩展 JdbcRealm, 解决了认证信息不包含数据库用户属性的问题。 能够在登录认证时，将用户在数据库的信息，全部自动封装到用户登录认证的Token(EasyUsernamePasswordToken)中。</p> </li> 
</ul> 
<h4> <a id="5-easyurlpermissionfilter基于-url-规则是否匹配的授权判断-perms扩展了-permissionsauthorizationfilter" class="anchor" href="#5-easyurlpermissionfilter%E5%9F%BA%E4%BA%8E-url-%E8%A7%84%E5%88%99%E6%98%AF%E5%90%A6%E5%8C%B9%E9%85%8D%E7%9A%84%E6%8E%88%E6%9D%83%E5%88%A4%E6%96%AD-perms%E6%89%A9%E5%B1%95%E4%BA%86-permissionsauthorizationfilter" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>5. EasyURLPermissionFilter：基于 URL 规则是否匹配的授权判断 Perms，扩展了 <code>PermissionsAuthorizationFilter</code>。</h4> 
<ul> 
 <li> <p>如果权限字符串（<code>StringPermissions</code>）中有该 URL 字符串，则允许访问，否则不允许</p> </li> 
 <li> <p>支持登录超时检测</p> </li> 
 <li> <p>支持<strong>Ajax 响应</strong>，Ajax 请求权限不足或登录超时时使用 JSON 输出（消息可通过 <code>permissionDeniedMsg</code>, <code>authenticationTimeoutMsg</code> 配置自定义）：</p> </li> 
</ul> 
<div class="highlight highlight-source-json">
 <pre>{ <span class="pl-s"><span class="pl-pds">&quot;</span>MSG<span class="pl-pds">&quot;</span></span>:<span class="pl-s"><span class="pl-pds">&quot;</span>您没有权限！<span class="pl-pds">&quot;</span></span>,<span class="pl-s"><span class="pl-pds">&quot;</span>statusCode<span class="pl-pds">&quot;</span></span>:<span class="pl-s"><span class="pl-pds">&quot;</span>401<span class="pl-pds">&quot;</span></span> }
{ <span class="pl-s"><span class="pl-pds">&quot;</span>MSG<span class="pl-pds">&quot;</span></span>:<span class="pl-s"><span class="pl-pds">&quot;</span>您的登录已过期，请重新登录！<span class="pl-pds">&quot;</span></span>,<span class="pl-s"><span class="pl-pds">&quot;</span>statusCode<span class="pl-pds">&quot;</span></span>:<span class="pl-s"><span class="pl-pds">&quot;</span>301<span class="pl-pds">&quot;</span></span> }</pre>
</div> 
<h4> <a id="6-登录认证相关自定义异常" class="anchor" href="#6-%E7%99%BB%E5%BD%95%E8%AE%A4%E8%AF%81%E7%9B%B8%E5%85%B3%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>6. 登录认证相关自定义异常</h4> 
<ul> 
 <li> <p><code>EasyIncorrectCaptchaException</code>，验证码错误异常，扩展了 <code>AuthenticationException</code></p> </li> 
 <li> <p><code>EasyLockLoginException</code>，登录锁定异常父类，扩展了 <code>AuthenticationException</code></p> </li> 
 <li> <p><code>EasyLockIPException</code>，IP锁定异常，扩展了 <code>EasyLockLoginException</code></p> </li> 
 <li> <p><code>EasyLockUserException</code>，用户锁定异常，扩展了 <code>EasyLockLoginException</code></p> </li> 
</ul> 
<h4> <a id="7-拦截器支持" class="anchor" href="#7-%E6%8B%A6%E6%88%AA%E5%99%A8%E6%94%AF%E6%8C%81" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>7. 拦截器支持</h4> 
<ul> 
 <li> <p><code>EasyAuthenticationInterceptor</code>，用户认证成功或识别拦截器（例如，可以在认证成功后进行用户锁定检测，或进行菜单查询初始化等扩展工作。）</p> </li> 
 <li> <p><code>EasyJdbcRealmInterceptor</code>， 认证与授权信息拦截器（例如，可以在获取授权或认证信息后，对进行二次处理，如对特定字符分割的权限字符串进行分割后重新存入 <code>StringPermissions</code> 等等。）</p> </li> 
</ul> 
<h2> <a id="基于-redis-的-session-缓存管理" class="anchor" href="#%E5%9F%BA%E4%BA%8E-redis-%E7%9A%84-session-%E7%BC%93%E5%AD%98%E7%AE%A1%E7%90%86" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>基于 Redis 的 Session 缓存管理</h2> 
<p><a href="https://github.com/ushelp/EasyShiro-Redis-Cache">EasyShiro-Redis-Cache</a> 是一个基于 Redis 的 Shrio 缓存，支持 Jedis 直连和 Spring-Data-Redis RedisTemplate。</p> 
<h3> <a id="maven" class="anchor" href="#maven" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Maven</h3> 
<div class="highlight highlight-text-xml">
 <pre>&lt;<span class="pl-ent">dependency</span>&gt;
	&lt;<span class="pl-ent">groupId</span>&gt;cn.easyproject&lt;/<span class="pl-ent">groupId</span>&gt;
	&lt;<span class="pl-ent">artifactId</span>&gt;easyshiro-redis-cache&lt;/<span class="pl-ent">artifactId</span>&gt;
	&lt;<span class="pl-ent">version</span>&gt;2.6.0-RELEASE&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre>
</div> 
<h3> <a id="配置" class="anchor" href="#%E9%85%8D%E7%BD%AE" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>配置</h3> 
<p>配置 RedisManager(Jedis) 或 RedisTemplate 连接。</p> 
<div class="highlight highlight-text-xml">
 <pre>	<span class="pl-c"><span class="pl-c">&lt;!--</span> RedisTemplate Start <span class="pl-c">--&gt;</span></span>
	<span class="pl-c"><span class="pl-c">&lt;!--</span> JedisPool <span class="pl-c">--&gt;</span></span>
	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>jedisPoolConfig<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redis.clients.jedis.JedisPoolConfig<span class="pl-pds">&quot;</span></span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>maxTotal<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.pool.maxTotal}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>maxIdle<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.pool.maxIdle}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>maxWaitMillis<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.pool.maxWaitMillis}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>testOnBorrow<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.pool.testOnBorrow}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>testOnReturn<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.pool.testOnReturn}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
	&lt;/<span class="pl-ent">bean</span>&gt;
	
	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>jedisConnFactory<span class="pl-pds">&quot;</span></span>
		class=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.data.redis.connection.jedis.JedisConnectionFactory<span class="pl-pds">&quot;</span></span>
		p:use-pool=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>hostName<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.host}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>port<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.port}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>database<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>${redis.database}<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		<span class="pl-c"><span class="pl-c">&lt;!--</span> &lt;property name=&quot;password&quot; value=&quot;pwd456&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>poolConfig<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>jedisPoolConfig<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
	&lt;/<span class="pl-ent">bean</span>&gt;
	
	<span class="pl-c"><span class="pl-c">&lt;!--</span> Redis template definition <span class="pl-c">--&gt;</span></span>
	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redisTemplate<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.data.redis.core.RedisTemplate<span class="pl-pds">&quot;</span></span>
		p:connection-factory-ref=<span class="pl-s"><span class="pl-pds">&quot;</span>jedisConnFactory<span class="pl-pds">&quot;</span></span>&gt;
		
		<span class="pl-c"><span class="pl-c">&lt;!--</span> !IMPORTANT: key is must 'StringRedisSerializer' <span class="pl-c">--&gt;</span></span>
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>keySerializer<span class="pl-pds">&quot;</span></span>&gt;
			&lt;<span class="pl-ent">bean</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.data.redis.serializer.StringRedisSerializer<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">bean</span>&gt;
		&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>hashKeySerializer<span class="pl-pds">&quot;</span></span>&gt;
			&lt;<span class="pl-ent">bean</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.data.redis.serializer.StringRedisSerializer<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">bean</span>&gt;
		&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>valueSerializer<span class="pl-pds">&quot;</span></span>&gt;
			&lt;<span class="pl-ent">bean</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.data.redis.serializer.JdkSerializationRedisSerializer<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">bean</span>&gt;
		&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>hashValueSerializer<span class="pl-pds">&quot;</span></span>&gt;
			&lt;<span class="pl-ent">bean</span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.springframework.data.redis.serializer.JdkSerializationRedisSerializer<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">bean</span>&gt;
		&lt;/<span class="pl-ent">property</span>&gt;
	&lt;/<span class="pl-ent">bean</span>&gt;
	<span class="pl-c"><span class="pl-c">&lt;!--</span> RedisTemplate End<span class="pl-c">--&gt;</span></span>
	

	<span class="pl-c"><span class="pl-c">&lt;!--</span> shiro redisManager <span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> 	&lt;bean id=&quot;redisManager&quot; class=&quot;cn.easyproject.shirorediscache.RedisManager&quot;&gt;</span>
<span class="pl-c">		&lt;property name=&quot;host&quot; value=&quot;127.0.0.1&quot;/&gt;</span>
<span class="pl-c">		&lt;property name=&quot;port&quot; value=&quot;6379&quot;/&gt;</span>
<span class="pl-c">		optional properties:</span>
<span class="pl-c">		&lt;property name=&quot;timeout&quot; value=&quot;10000&quot;/&gt;</span>
<span class="pl-c">		&lt;property name=&quot;password&quot; value=&quot;123456&quot;/&gt;</span>
<span class="pl-c">	&lt;/bean&gt; <span class="pl-c">--&gt;</span></span>
	
	
	<span class="pl-c"><span class="pl-c">&lt;!--</span> Session DAO (Redis) <span class="pl-c">--&gt;</span></span>
	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionDAO<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.shirorediscache.RedisSessionDAO<span class="pl-pds">&quot;</span></span>&gt;
		<span class="pl-c"><span class="pl-c">&lt;!--</span>  0 - never expire <span class="pl-c">--&gt;</span></span>
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>expire<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>1800<span class="pl-pds">&quot;</span></span>/&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redisTemplate<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redisTemplate<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
	<span class="pl-c"><span class="pl-c">&lt;!--</span> 	&lt;property name=&quot;redisManager&quot; ref=&quot;redisManager&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
	&lt;/<span class="pl-ent">bean</span>&gt;
	
	<span class="pl-c"><span class="pl-c">&lt;!--</span> Cache: Redis (securityManager) <span class="pl-c">--&gt;</span></span>
	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroCacheManagerRedis<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cn.easyproject.shirorediscache.RedisCacheManager<span class="pl-pds">&quot;</span></span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redisTemplate<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>redisTemplate<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 		&lt;property name=&quot;redisManager&quot; ref=&quot;redisManager&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
	&lt;/<span class="pl-ent">bean</span>&gt;
	
	<span class="pl-c"><span class="pl-c">&lt;!--</span> SecurityManager <span class="pl-c">--&gt;</span></span>
	&lt;<span class="pl-ent">bean</span> <span class="pl-e">id</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>securityManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">class</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>org.apache.shiro.web.mgt.DefaultWebSecurityManager<span class="pl-pds">&quot;</span></span>&gt;
		<span class="pl-c"><span class="pl-c">&lt;!--</span> &lt;property name=&quot;sessionMode&quot; value=&quot;native&quot;&gt;&lt;/property&gt; <span class="pl-c">--&gt;</span></span>
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		<span class="pl-c"><span class="pl-c">&lt;!--</span> Cache: Redis<span class="pl-c">--&gt;</span></span>
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>cacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroCacheManagerRedis<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rememberMeManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>rememberMeManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
		&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>realms<span class="pl-pds">&quot;</span></span>&gt;
			&lt;<span class="pl-ent">list</span>&gt;
				&lt;<span class="pl-ent">ref</span> <span class="pl-e">bean</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>jdbcRealm<span class="pl-pds">&quot;</span></span>/&gt;
			&lt;/<span class="pl-ent">list</span>&gt;
		&lt;/<span class="pl-ent">property</span>&gt;
	&lt;/<span class="pl-ent">bean</span>&gt;
	
	<span class="pl-c"><span class="pl-c">&lt;!--</span> ... <span class="pl-c">--&gt;</span></span></pre>
</div> 
<h2> <a id="其他功能配置" class="anchor" href="#%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD%E9%85%8D%E7%BD%AE" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>其他功能配置</h2> 
<ul> 
 <li> <h3> <a id="权限刷新" class="anchor" href="#%E6%9D%83%E9%99%90%E5%88%B7%E6%96%B0" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>权限刷新</h3> </li> 
</ul> 
<p><code>EasyJdbcRealm</code> 提供了静态的 <code>reloadPermissions</code> 方法，可以在认证成功后直接刷新权限（例如：重新分配用户权限后，刷新当前用户的最新权限。）</p> 
<ul> 
 <li> <h3> <a id="登录消息提示管理" class="anchor" href="#%E7%99%BB%E5%BD%95%E6%B6%88%E6%81%AF%E6%8F%90%E7%A4%BA%E7%AE%A1%E7%90%86" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>登录消息提示管理</h3> </li> 
</ul> 
<p>EasyFormAuthenticationFilter 能够按照异常配置相应错误提示信息，并根据配置保存进 request 或 session。</p> 
<h4> <a id="1-错误消息自定义配置" class="anchor" href="#1-%E9%94%99%E8%AF%AF%E6%B6%88%E6%81%AF%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. 错误消息自定义配置</h4> 
<div class="highlight highlight-text-xml">
 <pre><span class="pl-c"><span class="pl-c">&lt;!--</span> ## 登录失败相关错误消息 ## <span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> 登录失败，消息 key  <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>msgKey<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>MSG<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 将消息存入session，session.setAttribute(MsgKey,xxxErrorMsg); default is 'false' <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>sessionMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 将消息存入request，request.setAttribute(MsgKey,xxxErrorMsg); default is 'false' <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>requestMsg<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> # 登录错误的，异常提示内容 Map<span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>exceptionMsg<span class="pl-pds">&quot;</span></span>&gt;
    &lt;<span class="pl-ent">map</span>&gt;
        <span class="pl-c"><span class="pl-c">&lt;!--</span> ExceptionClassName:&quot;Message&quot;, ExceptionClassName2:&quot;Message2&quot;, ... <span class="pl-c">--&gt;</span></span>
        &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>LockedAccountException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>账户锁定，请联系管理员解锁。<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
        
        &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>AuthenticationException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>用户名或密码有误！<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
        
        &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>EasyIncorrectCaptchaException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>验证码有误！<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
        &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>EasyLockUserException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>由于该用户连续登录错误，暂时被锁定 2 小时，请稍后再试。<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
        &lt;<span class="pl-ent">entry</span> <span class="pl-e">key</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>EasyLockIPException<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>由于该IP连续登录错误，暂时被锁定 2 小时，请稍后再试。<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">entry</span>&gt;
    &lt;/<span class="pl-ent">map</span>&gt;
&lt;/<span class="pl-ent">property</span>&gt;</pre>
</div> 
<pre><code>#---- 登录失败相关错误消息
# 登录失败，消息 key 
auth.msgKey = MSG
# 将消息存入session，session.setAttribute(MsgKey,xxxErrorMsg); default is 'false'
auth.sessionMsg = true
# 将消息存入request，request.setAttribute(MsgKey,xxxErrorMsg); default is 'false'
auth.requestMsg = true
# 登录错误的，异常提示内容 Map
# ExceptionClassName:&quot;Message&quot;, ExceptionClassName2:&quot;Message2&quot;, ...
auth.exceptionMsg = LockedAccountException:&quot;账户锁定，请联系管理员解锁。&quot;, AuthenticationException:&quot;用户名，或密码有误！&quot;, EasyIncorrectCaptchaException:&quot;验证码有误！&quot;, EasyLockUserException:&quot;由于该用户连续登录错误，暂时被锁定 2 小时，请稍后再试。&quot;, EasyLockIPException:&quot;由于该IP连续登录错误，暂时被锁定 2 小时，请稍后再试。&quot;
</code></pre> 
<h4> <a id="2-页面消息提醒示例" class="anchor" href="#2-%E9%A1%B5%E9%9D%A2%E6%B6%88%E6%81%AF%E6%8F%90%E9%86%92%E7%A4%BA%E4%BE%8B" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. 页面消息提醒示例</h4> 
<pre><code>&lt;!-- 登录消息提示JS --&gt;
&lt;s:if test=&quot;#session.MSG!=null&quot;&gt;
	&lt;script type=&quot;text/javascript&quot;&gt;
		$(function() {
			uiEx.alert(&quot;${MSG }&quot;, &quot;info&quot;);
		})
	&lt;/script&gt;
	&lt;s:set name=&quot;MSG&quot; scope=&quot;session&quot; value=&quot;&quot;&gt;&lt;/s:set&gt;
&lt;/s:if&gt;
</code></pre> 
<h2> <a id="locklogin-登录锁定" class="anchor" href="#locklogin-%E7%99%BB%E5%BD%95%E9%94%81%E5%AE%9A" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>LockLogin 登录锁定</h2> 
<p><code>EasyFormAuthenticationFilter</code> 提供了基于 <code>EhCache</code> 的 LockLogin 登录锁定功能。</p> 
<h3> <a id="1-ehcachexml-配置" class="anchor" href="#1-ehcachexml-%E9%85%8D%E7%BD%AE" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>1. ehcache.xml 配置</h3> 
<p>使用LockLogin, 必须配置登录锁定相关的 EhCache 缓存配置 <code>shiro-lockLoginCache</code>，<code>shiro-lockCheckCache</code>。</p> 
<div class="highlight highlight-text-xml">
 <pre><span class="pl-c"><span class="pl-c">&lt;!--</span> ## LockLogin Configuration ## <span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 管理锁定时间周期的 EHCache 缓存名称<span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> 只需调整timeToIdleSeconds，默认达到登录锁定次数，登录锁定  2 小时 <span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin name cache management locks EHCache time period<span class="pl-c">--&gt;</span></span>
<span class="pl-c"><span class="pl-c">&lt;!--</span> Simply adjust timeToIdleSeconds, the default number of times to reach the login lockout, login lockout 2 Hours<span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">cache</span>
   	    <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiro-lockLoginCache<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">maxElementsInMemory</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>100000<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">eternal</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>false<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">timeToIdleSeconds</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>0<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">timeToLiveSeconds</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>7200<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">diskExpiryThreadIntervalSeconds</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>600<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">memoryStoreEvictionPolicy</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>LRU<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">overflowToDisk</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>
        <span class="pl-e">diskPersistent</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;
&lt;/<span class="pl-ent">cache</span>&gt;
  
 <span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 统计登录错误次数时间周期的 EHCache 缓存名称 <span class="pl-c">--&gt;</span></span>
 <span class="pl-c"><span class="pl-c">&lt;!--</span> 只需调整timeToIdleSeconds，默认统计 10 分钟内的错误次数  <span class="pl-c">--&gt;</span></span>
 <span class="pl-c"><span class="pl-c">&lt;!--</span> EHCache caching name Lock Login login error statistics of the number of time periods <span class="pl-c">--&gt;</span></span>
 <span class="pl-c"><span class="pl-c">&lt;!--</span> Simply adjust timeToIdleSeconds, default statistics the number of errors in 10 minutes <span class="pl-c">--&gt;</span></span>
 &lt;<span class="pl-ent">cache</span>
 	    <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiro-lockCheckCache<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">maxElementsInMemory</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>100000<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">eternal</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>false<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">timeToIdleSeconds</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>0<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">timeToLiveSeconds</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>600<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">diskExpiryThreadIntervalSeconds</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>600<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">memoryStoreEvictionPolicy</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>LRU<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">overflowToDisk</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>
      <span class="pl-e">diskPersistent</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;
  &lt;/<span class="pl-ent">cache</span>&gt;</pre>
</div> 
<h3> <a id="2-locklogin-控制" class="anchor" href="#2-locklogin-%E6%8E%A7%E5%88%B6" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>2. LockLogin 控制</h3> 
<ul> 
 <li>基于用户名（User）的锁定控制</li> 
 <li>基于 IP 的锁定控制</li> 
 <li>基于 IP 的验证码是否显示控制</li> 
</ul> 
<div class="highlight highlight-text-xml">
 <pre><span class="pl-c"><span class="pl-c">&lt;!--</span> 是否开启LockLogin用户登录锁定；默认为false，不开启 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>enableLockLogin<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>true<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> Shiro CacheManager <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>ehCacheManager<span class="pl-pds">&quot;</span></span> <span class="pl-e">ref</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiroCacheManager<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 管理锁定时间周期的 EHCache 缓存名称；默认为 shiro-lockLoginCache <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>lockLoginCacheName<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiro-lockLoginCache<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> LockLogin 统计登录错误次数时间周期的 EHCache 缓存名称；默认为 shiro-lockCheckCache <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>lockCheckCacheName<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>shiro-lockCheckCache<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 同一用户名登录达到登录错误次数，登录锁定；0为不限制；默认为6 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>userLock<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>4<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span>  同一IP登录达到错误次数，登录锁定；0为不限制；默认为15 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>ipLock<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>6<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;
<span class="pl-c"><span class="pl-c">&lt;!--</span> 达到指定登录错误次数，显示验证码；-1为不控制验证码显示；默认为1 <span class="pl-c">--&gt;</span></span>
&lt;<span class="pl-ent">property</span> <span class="pl-e">name</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>showCaptcha<span class="pl-pds">&quot;</span></span> <span class="pl-e">value</span>=<span class="pl-s"><span class="pl-pds">&quot;</span>1<span class="pl-pds">&quot;</span></span>&gt;&lt;/<span class="pl-ent">property</span>&gt;</pre>
</div> 
<pre><code>#---- LockLogin Configuration 登录失败相关错误消息
# 是否开启LockLogin用户登录锁定；默认为false，不开启
auth.enableLockLogin=false
# Shiro CacheManager 
auth.ehCacheManager=$cacheManager
# LockLogin 管理锁定时间周期的 EHCache 缓存名称；默认为 shiro-lockLoginCache
auth.lockLoginCacheName=shiro-lockLoginCache
# LockLogin 统计登录错误次数时间周期的 EHCache 缓存名称；默认为 shiro-lockCheckCache 
auth.lockCheckCacheName=shiro-lockCheckCache
# 同一用户名登录达到登录错误次数，登录锁定；0为不限制；默认为6 
auth.userLock=4
#  同一IP登录达到错误次数，登录锁定；0为不限制；默认为15 
auth.ipLock=6
# 达到指定登录错误次数，显示验证码；-1为不控制验证码显示；默认为1 
auth.showCaptcha=2
</code></pre> 
<h3> <a id="3-锁定判断" class="anchor" href="#3-%E9%94%81%E5%AE%9A%E5%88%A4%E6%96%AD" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>3. 锁定判断</h3> 
<p>EasyShiro 的 <code>EasyFormAuthenticationFilter</code> 过滤器在跳转到登录页面时已经检测了是否需要显示验证码或IP是否锁定，并将信息存入 <code>Session</code>。在页面可以从 <code>Session</code> 中获取判断信息。</p> 
<ul> 
 <li>IP 是否锁定 <code>session.IPLock</code> </li> 
</ul> 
<pre><code>&lt;s:if test=&quot;#session.IPLock!=null&quot;&gt;
	&lt;span style=&quot;color:#ff0000; font-weight:bold&quot;&gt;您的 IP 地址由于连续登录错误过多，已被锁定 2 小时，请稍后再试。&lt;/span&gt;
&lt;/s:if&gt;
</code></pre> 
<ul> 
 <li>是否需要显示验证码 <code>session.ShowCAPTCHA</code> </li> 
</ul> 
<pre><code>&lt;s:if test=&quot;#session.ShowCAPTCHA!=null&quot;&gt; 
     &lt;tr&gt;
          &lt;td&gt;Verification:&lt;/td&gt;
          &lt;td&gt;
                &lt;input class=&quot;easyui-validatebox textbox&quot;
                id=&quot;captcha&quot; name=&quot;captcha&quot;   
                style=&quot;height:30px;width: 80px;&quot; data-options=&quot;required:true, validType:'minLength[4]' , tipPosition:'right',position:'bottom', deltaX:105&quot;
                maxlength=&quot;4&quot;&gt;&lt;/input&gt; 
                &lt;div style=&quot;display: none; float: right; border: 1px solid #ccc;&quot; id=&quot;vcTr&quot;&gt;
                     &lt;img  title=&quot;点击切换&quot; alt=&quot;加载中...&quot; align=&quot;middle&quot;
                     style=&quot;cursor: pointer;&quot; width=&quot;100&quot; height=&quot;28&quot; id=&quot;vcImg&quot; src=&quot;jsp/VerifyCode.jsp&quot;&gt;
                &lt;/div&gt;
          &lt;/td&gt;
     &lt;/tr&gt;   
&lt;/s:if&gt;  
</code></pre> 
<h3> <a id="4-登录锁定解锁系统-lockloginmanagement" class="anchor" href="#4-%E7%99%BB%E5%BD%95%E9%94%81%E5%AE%9A%E8%A7%A3%E9%94%81%E7%B3%BB%E7%BB%9F-lockloginmanagement" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>4. 登录锁定解锁系统 LockLoginManagement</h3> 
<ul> 
 <li>将 <code>locklogin</code> 放入 web 根目录，访问即可:</li> 
</ul> 
<pre><code>http://127.0.0.1:8088/easyee-ssh/locklogin/admin.jsp
</code></pre> 
<ul> 
 <li>默认缓存代码如下，您可根据需要进行修改</li> 
</ul> 
<pre><code>String lockLogin=&quot;shiro-lockLoginCache&quot;;
String lockLCheck=&quot;shiro-lockCheckCache&quot;;
</code></pre> 
<ul> 
 <li> <code>locklogin/admin.jsp</code> 并没有进行权限控制，注意使用时进行访问控制</li> 
</ul> 
<p><a href="images/locklogin1.png" target="_blank"><img src="images/locklogin1.png" alt="LockLogin" style="max-width:100%;" /></a></p> 
<p><a href="images/locklogin2.png" target="_blank"><img src="images/locklogin2.png" alt="LockLogin" style="max-width:100%;" /></a></p> 
<p><a href="images/locklogin3.png" target="_blank"><img src="images/locklogin3.png" alt="LockLogin" style="max-width:100%;" /></a></p> 
<p><a href="images/locklogin4.png" target="_blank"><img src="images/locklogin4.png" alt="LockLogin" style="max-width:100%;" /></a></p> 
<p><a href="images/locklogin5.png" target="_blank"><img src="images/locklogin5.png" alt="LockLogin" style="max-width:100%;" /></a></p> 
<h2> <a id="end" class="anchor" href="#end" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>END</h2> 
<h3> <a id="官方主页" class="anchor" href="#%E5%AE%98%E6%96%B9%E4%B8%BB%E9%A1%B5" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="http://www.easyproject.cn/easyshiro/zh-cn/index.jsp" title="官方主页" rel="nofollow">官方主页</a> </h3> 
<p><a href="http://www.easyproject.cn/easyshiro/zh-cn/index.jsp#donation" title="留言评论" rel="nofollow">留言评论</a></p> 
<p>如果您有更好意见，建议或想法，请联系我。</p> 
<h3> <a id="the-official-home-page" class="anchor" href="#the-official-home-page" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a><a href="http://www.easyproject.cn/easyshiro/en/index.jsp" title="The official home page" rel="nofollow">The official home page</a> </h3> 
<p><a href="http://www.easyproject.cn/easyshiro/en/index.jsp#donation" title="Comments" rel="nofollow">Comments</a></p> 
<p>If you have more comments, suggestions or ideas, please contact me.</p> 
<p>Email：<a href="mailto:inthinkcolor@gmail.com">inthinkcolor@gmail.com</a></p> 
<p><a href="http://www.easyproject.cn" title="EasyProject Home" rel="nofollow">http://www.easyproject.cn</a></p> 
<p><strong>支付宝钱包扫一扫捐助：</strong></p> 
<p>我们相信，每个人的点滴贡献，都将是推动产生更多、更好免费开源产品的一大步。</p> 
<p><strong>感谢慷慨捐助，以支持服务器运行和鼓励更多社区成员。</strong></p> 
<p><a href="https://camo.githubusercontent.com/0079923bf4bc9ed15a8be36a117559592e024d1b/687474703a2f2f7777772e6561737970726f6a6563742e636e2f696d616765732f732e706e67" target="_blank" rel="nofollow"><img alt="支付宝钱包扫一扫捐助" src="https://camo.githubusercontent.com/0079923bf4bc9ed15a8be36a117559592e024d1b/687474703a2f2f7777772e6561737970726f6a6563742e636e2f696d616765732f732e706e67" title="支付宝钱包扫一扫捐助" height="256" width="256" data-canonical-src="http://www.easyproject.cn/images/s.png" style="max-width:100%;" /></a></p> 
<p>We believe that the contribution of each bit by bit, will be driven to produce more and better free and open source products a big step.</p> 
<p><strong>Thank you donation to support the server running and encourage more community members.</strong></p> 
<p><a href="https://www.paypal.me/easyproject/10" title="Make payments with PayPal - it's fast, free and secure!" rel="nofollow"><img src="https://camo.githubusercontent.com/25fd45a9c199091fd684c9f11b37c386b4301087/687474703a2f2f7777772e6561737970726f6a6563742e636e2f696d616765732f70617970616c646f6e6174696f6e352e6a7067" alt="PayPal" data-canonical-src="http://www.easyproject.cn/images/paypaldonation5.jpg" style="max-width:100%;" /></a></p>
</body>
</html>
